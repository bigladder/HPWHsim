<!doctype html>

<html>

    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <title>HPWH measured vs. simulation</title>

    </head>


    <body>

    <form id="functionForm">
        <label for="arg1">model spec:</label>
        <input type="text" id="arg1" name="arg1" required><br><br>

        <label for="arg2">model name:</label>
        <input type="text" id="arg2" name="arg2" required><br><br>

        <label for="arg3">test name:</label>
        <input type="text" id="arg3" name="arg3" required><br><br>

        <label for="arg4">plot name:</label>
        <input type="text" id="arg4" name="arg4" required><br><br>

        <label for="arg5">measurements name:</label>
        <input type="text" id="arg5" name="arg5" required><br><br>

        <button type="button" id="Btn" onclick="simulate_and_plot();">simulate and plot</button>
    </form>

    <iframe title="Plots" src="../../build/test/output/" id="plots" width=1200 height=800 style="display:none;"></iframe>

    <div id="output"></div>

    <script>
        const form = document.getElementById('functionForm');
        form.arg1.value = "File";
        form.arg2.value = "AeroTherm2023";
        form.arg3.value = "RE2H50_UEF67";
        form.arg4.value = "aplot_67.html"
        form.arg5.value = "measurements_test.csv";
    </script>

    <script>

        async function simulate_and_plot() {
            const form = document.getElementById('functionForm');
            const farg1 = form.arg1.value;
            const farg2 = form.arg2.value;
            const farg3 = form.arg3.value;
            const farg4 = form.arg4.value;
            const farg5 = form.arg5.value;
            fst = 'arg1=' + farg1;
            fst += '&arg2=' + farg2;
            fst += '&arg3=' + farg3;
            fst += '&arg4=' + farg4;
            fst += '&arg5=' + farg5;

            document.getElementById("Btn").disabled = true;

            const response = await fetch('http://localhost:8000/run_python_function?' + fst)

            form.arg1.value = farg1;
            form.arg2.value = farg2;
            form.arg3.value = farg3;
            form.arg4.value = farg4;
            form.arg5.value = farg5;

            document.getElementById("plots").src="../../build/test/output/" + farg4
            document.getElementById("plots").style="display:block;"

            //document.getElementById("plots").contentWindow.location.reload();

            document.getElementById("Btn").disabled = false;

            //window.location.reload();
        }

    </script>

    </body>

    </html>